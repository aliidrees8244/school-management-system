<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exam Reports - Muslim Educators School Kot Hussain</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      max-width: 900px;
      margin: 30px auto;
      background: #fff;
      color: #222;
      padding: 0 15px;
    }
    h1 {
      text-align: center;
      color: #003366;
      margin-bottom: 25px;
      user-select: none;
    }
    .top-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    .top-buttons a {
      text-decoration: none;
      background-color: #003366;
      color: #fff;
      padding: 10px 22px;
      border-radius: 5px;
      font-weight: 600;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    .top-buttons a:hover {
      background-color: #001f4d;
    }
    .filters {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    label {
      font-weight: 600;
      color: #003366;
      margin-right: 6px;
      user-select: none;
    }
    select, input[type="text"] {
      padding: 6px 12px;
      border-radius: 5px;
      border: 1px solid #003366;
      outline: none;
      font-size: 15px;
      min-width: 150px;
      user-select: text;
    }
    select:focus, input[type="text"]:focus {
      border-color: #001f4d;
    }
    .stats-summary {
      max-width: 400px;
      margin: 0 auto 30px;
      display: flex;
      justify-content: space-around;
      font-weight: 600;
      color: #003366;
      user-select: none;
    }
    .stats-summary div {
      background: #e6f0fa;
      padding: 10px 18px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgb(0 0 0 / 0.1);
      min-width: 120px;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      box-shadow: 0 0 10px rgb(0 0 0 / 0.05);
    }
    th, td {
      border: 1px solid #003366;
      padding: 10px 14px;
      text-align: center;
      font-size: 14px;
      user-select: text;
    }
    th {
      background-color: #003366;
      color: white;
      font-weight: 700;
      user-select: none;
    }
    tr:nth-child(even) {
      background-color: #f9fbff;
    }
    .no-data {
      text-align: center;
      padding: 18px 0;
      color: #777;
      user-select: none;
    }
    /* Pagination */
    .pagination {
      text-align: center;
      margin-bottom: 50px;
      user-select: none;
    }
    .pagination button {
      background: #003366;
      color: #fff;
      border: none;
      padding: 6px 14px;
      margin: 0 4px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }
    .pagination button:disabled {
      background: #ccc;
      cursor: default;
    }
    .pagination button:hover:not(:disabled) {
      background: #001f4d;
    }
    /* Responsive */
    @media (max-width: 600px) {
      .filters {
        flex-direction: column;
        gap: 15px;
      }
      .stats-summary {
        flex-direction: column;
        gap: 10px;
      }
      th, td {
        font-size: 12px;
        padding: 8px;
      }
    }
  </style>
</head>
<body>

  <h1>Exam Reports</h1>

  <div class="top-buttons">
    <a href="index.html" title="Go to Main Dashboard">üè† Dashboard</a>
    <a href="exam-management.html" title="Manage Exams">üìù Manage Exams</a>
  </div>

  <div class="filters" role="region" aria-label="Filters">
    <div>
      <label for="classFilter">Filter by Class:</label>
      <select id="classFilter" aria-controls="reportTable">
        <option value="">All Classes</option>
        <option>Play Group</option>
        <option>Nursery</option>
        <option>KG</option>
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
        <option>6</option>
        <option>7</option>
        <option>8</option>
        <option>9</option>
        <option>10</option>
      </select>
    </div>
    <div>
      <label for="subjectFilter">Filter by Subject:</label>
      <select id="subjectFilter" aria-controls="reportTable">
        <option value="">All Subjects</option>
      </select>
    </div>
    <div>
      <label for="searchInput">Search Exam Type:</label>
      <input type="text" id="searchInput" placeholder="Type exam name..." aria-controls="reportTable" />
    </div>
  </div>

  <div class="stats-summary" aria-live="polite" aria-atomic="true">
    <div>Total Exams: <span id="totalExams">0</span></div>
    <div>Unique Classes: <span id="uniqueClasses">0</span></div>
    <div>Unique Subjects: <span id="uniqueSubjects">0</span></div>
  </div>

  <table id="reportTable" aria-describedby="tableDescription" role="table">
    <caption id="tableDescription" class="sr-only">List of exams filtered by class, subject, and exam type</caption>
    <thead>
      <tr>
        <th>Exam Type</th>
        <th>Class</th>
        <th>Subject</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data rows inserted here -->
    </tbody>
  </table>

  <div class="pagination" aria-label="Pagination Controls">
    <button id="prevPage" aria-label="Previous Page" disabled>¬´ Prev</button>
    <span id="pageInfo" aria-live="polite" style="margin: 0 15px;">Page 1</span>
    <button id="nextPage" aria-label="Next Page" disabled>Next ¬ª</button>
  </div>

<script>
  // Constants
  const ITEMS_PER_PAGE = 10;

  // Elements
  const classFilter = document.getElementById('classFilter');
  const subjectFilter = document.getElementById('subjectFilter');
  const searchInput = document.getElementById('searchInput');
  const reportTableBody = document.querySelector('#reportTable tbody');
  const totalExamsElem = document.getElementById('totalExams');
  const uniqueClassesElem = document.getElementById('uniqueClasses');
  const uniqueSubjectsElem = document.getElementById('uniqueSubjects');
  const prevPageBtn = document.getElementById('prevPage');
  const nextPageBtn = document.getElementById('nextPage');
  const pageInfo = document.getElementById('pageInfo');

  let allExams = [];
  let filteredExams = [];
  let currentPage = 1;

  // Load exams from localStorage
  function loadExams() {
    allExams = JSON.parse(localStorage.getItem('exams')) || [];
    populateSubjectFilter();
    applyFilters();
  }

  // Populate subject filter dropdown dynamically based on exams data
  function populateSubjectFilter() {
    // Extract unique subjects sorted alphabetically
    const subjects = [...new Set(allExams.map(ex => ex.subject).filter(s => s && s.trim() !== ''))].sort();

    // Clear current options except first
    subjectFilter.innerHTML = '<option value="">All Subjects</option>';

    subjects.forEach(sub => {
      const option = document.createElement('option');
      option.value = sub;
      option.textContent = sub;
      subjectFilter.appendChild(option);
    });
  }

  // Apply filters and update the table and stats
  function applyFilters() {
    const classVal = classFilter.value;
    const subjectVal = subjectFilter.value;
    const searchVal = searchInput.value.trim().toLowerCase();

    filteredExams = allExams.filter(exam => {
      let match = true;
      if (classVal && exam.class !== classVal) match = false;
      if (subjectVal && exam.subject !== subjectVal) match = false;
      if (searchVal && !exam.type.toLowerCase().includes(searchVal)) match = false;
      return match;
    });

    currentPage = 1;
    renderTable();
    updateStats();
    updatePagination();
  }

  // Render exams table rows with pagination
  function renderTable() {
    reportTableBody.innerHTML = '';

    if (filteredExams.length === 0) {
      reportTableBody.innerHTML = `<tr><td colspan="4" class="no-data">No exams found matching criteria.</td></tr>`;
      return;
    }

    const startIdx = (currentPage - 1) * ITEMS_PER_PAGE;
    const pageExams = filteredExams.slice(startIdx, startIdx + ITEMS_PER_PAGE);

    pageExams.forEach(exam => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${exam.type}</td>
        <td>${exam.class}</td>
        <td>${exam.subject}</td>
        <td>${exam.date}</td>
      `;
      reportTableBody.appendChild(tr);
    });
  }

  // Update summary statistics
  function updateStats() {
    totalExamsElem.textContent = filteredExams.length;

    // Unique classes and subjects in filtered exams
    const uniqueClasses = [...new Set(filteredExams.map(ex => ex.class))];
    const uniqueSubjects = [...new Set(filteredExams.map(ex => ex.subject))];

    uniqueClassesElem.textContent = uniqueClasses.length;
    uniqueSubjectsElem.textContent = uniqueSubjects.length;
  }

  // Update pagination buttons and info
  function updatePagination() {
    const totalPages = Math.ceil(filteredExams.length / ITEMS_PER_PAGE);
    pageInfo.textContent = `Page ${currentPage} of ${totalPages || 1}`;

    prevPageBtn.disabled = currentPage <= 1;
    nextPageBtn.disabled = currentPage >= totalPages;
  }

  // Pagination button handlers
  prevPageBtn.addEventListener('click', () => {
    if (currentPage > 1) {
      currentPage--;
      renderTable();
      updatePagination();
    }
  });

  nextPageBtn.addEventListener('click', () => {
    const totalPages = Math.ceil(filteredExams.length / ITEMS_PER_PAGE);
    if (currentPage < totalPages) {
      currentPage++;
      renderTable();
      updatePagination();
    }
  });

  // Filter event listeners
  classFilter.addEventListener('change', applyFilters);
  subjectFilter.addEventListener('change', applyFilters);
  searchInput.addEventListener('input', applyFilters);

  // Initial load
  loadExams();
</script>

</body>
</html>
